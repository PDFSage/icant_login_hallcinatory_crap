{"ast":null,"code":"// frontend/src/components/Dashboard.js\nimport React,{useEffect,useState}from'react';import axios from'axios';import{useNavigate}from'react-router-dom';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";export default function Dashboard(){const navigate=useNavigate();const[docs,setDocs]=useState([]);const[file,setFile]=useState(null);const[isAdmin,setIsAdmin]=useState(false);const[risk,setRisk]=useState({});const[credentials,setCredentials]=useState([]);const[credType,setCredType]=useState('');const[credValue,setCredValue]=useState('');const handleLogout=async()=>{await axios.post('/api/logout',{},{withCredentials:true});navigate('/login');};const getDocs=async()=>{const res=await axios.get('/api/docs',{withCredentials:true});setDocs(res.data.docs);};const uploadFile=async e=>{e.preventDefault();if(!file)return;const formData=new FormData();formData.append('file',file);try{await axios.post('/api/upload',formData,{withCredentials:true});getDocs();}catch{alert('Upload failed');}};const getLeakRisk=async()=>{try{const res=await axios.get('/api/leak_risk',{withCredentials:true});setRisk(res.data.risk||{});}catch{}};const checkAdmin=async()=>{try{const r=await axios.get('/api/leak_risk',{withCredentials:true});if(r.data&&r.data.risk){setIsAdmin(true);setRisk(r.data.risk);}}catch{setIsAdmin(false);}};const getCredentialsList=async()=>{try{const r=await axios.get('/api/get_credentials',{withCredentials:true});setCredentials(r.data.credentials||[]);}catch{}};const addCredential=async e=>{e.preventDefault();try{await axios.post('/api/add_credential',{type:credType,value:credValue},{withCredentials:true});setCredType('');setCredValue('');getCredentialsList();}catch{}};useEffect(()=>{(async()=>{await axios.get('/api/graph',{credentials:'include'});})();getDocs();checkAdmin();getCredentialsList();},[]);return/*#__PURE__*/_jsxs(\"div\",{className:\"dashboard-container\",children:[/*#__PURE__*/_jsx(\"h1\",{children:\"Federal Top Secret Dashboard\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>navigate('/graph'),children:\"View Global Graph\"}),/*#__PURE__*/_jsx(\"button\",{onClick:handleLogout,children:\"Logout\"}),isAdmin&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"hr\",{}),/*#__PURE__*/_jsx(\"h2\",{children:\"Leak Risk Prediction\"}),/*#__PURE__*/_jsx(\"button\",{onClick:getLeakRisk,children:\"Refresh Risk\"}),/*#__PURE__*/_jsx(\"ul\",{children:Object.keys(risk).map(u=>/*#__PURE__*/_jsxs(\"li\",{children:[u,\": \",risk[u].toFixed(3)]},u))})]}),/*#__PURE__*/_jsx(\"hr\",{}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:uploadFile,children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Upload Document\"}),/*#__PURE__*/_jsx(\"input\",{type:\"file\",onChange:e=>setFile(e.target.files[0])}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",children:\"Upload\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"docs-list\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Documents\"}),docs.map(d=>/*#__PURE__*/_jsxs(\"div\",{children:[d.filename,\" (uploader: \",d.uploader,\")\"]},d.id))]}),/*#__PURE__*/_jsx(\"hr\",{}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Credentials Manager\"}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:addCredential,children:[/*#__PURE__*/_jsx(\"input\",{placeholder:\"Type\",value:credType,onChange:e=>setCredType(e.target.value)}),/*#__PURE__*/_jsx(\"input\",{placeholder:\"Value\",value:credValue,onChange:e=>setCredValue(e.target.value)}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",children:\"Add\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"credentials-list\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Your Credentials\"}),credentials.map(c=>/*#__PURE__*/_jsxs(\"div\",{children:[c.type,\": \",c.value]},c.id))]})]})]});}","map":{"version":3,"names":["React","useEffect","useState","axios","useNavigate","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","Dashboard","navigate","docs","setDocs","file","setFile","isAdmin","setIsAdmin","risk","setRisk","credentials","setCredentials","credType","setCredType","credValue","setCredValue","handleLogout","post","withCredentials","getDocs","res","get","data","uploadFile","e","preventDefault","formData","FormData","append","alert","getLeakRisk","checkAdmin","r","getCredentialsList","addCredential","type","value","className","children","onClick","Object","keys","map","u","toFixed","onSubmit","onChange","target","files","d","filename","uploader","id","placeholder","c"],"sources":["/Users/bo/d3flask_tf_skl_opencv_tesseract_react_router_sample_maybe_cupy/frontend/src/components/Dashboard.js"],"sourcesContent":["// frontend/src/components/Dashboard.js\nimport React, { useEffect, useState } from 'react'\nimport axios from 'axios'\nimport { useNavigate } from 'react-router-dom'\n\nexport default function Dashboard() {\n  const navigate = useNavigate()\n  const [docs, setDocs] = useState([])\n  const [file, setFile] = useState(null)\n  const [isAdmin, setIsAdmin] = useState(false)\n  const [risk, setRisk] = useState({})\n  const [credentials, setCredentials] = useState([])\n  const [credType, setCredType] = useState('')\n  const [credValue, setCredValue] = useState('')\n\n  const handleLogout = async () => {\n    await axios.post('/api/logout', {}, { withCredentials: true })\n    navigate('/login')\n  }\n\n  const getDocs = async () => {\n    const res = await axios.get('/api/docs', { withCredentials: true })\n    setDocs(res.data.docs)\n  }\n\n  const uploadFile = async e => {\n    e.preventDefault()\n    if (!file) return\n    const formData = new FormData()\n    formData.append('file', file)\n    try {\n      await axios.post('/api/upload', formData, { withCredentials: true })\n      getDocs()\n    } catch {\n      alert('Upload failed')\n    }\n  }\n\n  const getLeakRisk = async () => {\n    try {\n      const res = await axios.get('/api/leak_risk', { withCredentials: true })\n      setRisk(res.data.risk || {})\n    } catch {}\n  }\n\n  const checkAdmin = async () => {\n    try {\n      const r = await axios.get('/api/leak_risk', { withCredentials: true })\n      if (r.data && r.data.risk) {\n        setIsAdmin(true)\n        setRisk(r.data.risk)\n      }\n    } catch {\n      setIsAdmin(false)\n    }\n  }\n\n  const getCredentialsList = async () => {\n    try {\n      const r = await axios.get('/api/get_credentials', { withCredentials: true })\n      setCredentials(r.data.credentials || [])\n    } catch {}\n  }\n\n  const addCredential = async e => {\n    e.preventDefault()\n    try {\n      await axios.post('/api/add_credential', { type: credType, value: credValue }, { withCredentials: true })\n      setCredType('')\n      setCredValue('')\n      getCredentialsList()\n    } catch {}\n  }\n\n  useEffect(() => {\n    (async () => {\n      await axios.get('/api/graph', { credentials: 'include' })\n    })()\n    getDocs()\n    checkAdmin()\n    getCredentialsList()\n  }, [])\n\n  return (\n    <div className=\"dashboard-container\">\n      <h1>Federal Top Secret Dashboard</h1>\n      <button onClick={() => navigate('/graph')}>View Global Graph</button>\n      <button onClick={handleLogout}>Logout</button>\n      {isAdmin && (\n        <>\n          <hr/>\n          <h2>Leak Risk Prediction</h2>\n          <button onClick={getLeakRisk}>Refresh Risk</button>\n          <ul>\n            {Object.keys(risk).map(u => (\n              <li key={u}>{u}: {risk[u].toFixed(3)}</li>\n            ))}\n          </ul>\n        </>\n      )}\n      <hr/>\n      <form onSubmit={uploadFile}>\n        <h2>Upload Document</h2>\n        <input type=\"file\" onChange={e => setFile(e.target.files[0])} />\n        <button type=\"submit\">Upload</button>\n      </form>\n      <div className=\"docs-list\">\n        <h2>Documents</h2>\n        {docs.map(d => <div key={d.id}>{d.filename} (uploader: {d.uploader})</div>)}\n      </div>\n      <hr/>\n      <div>\n        <h2>Credentials Manager</h2>\n        <form onSubmit={addCredential}>\n          <input placeholder=\"Type\" value={credType} onChange={e => setCredType(e.target.value)} />\n          <input placeholder=\"Value\" value={credValue} onChange={e => setCredValue(e.target.value)} />\n          <button type=\"submit\">Add</button>\n        </form>\n        <div className=\"credentials-list\">\n          <h3>Your Credentials</h3>\n          {credentials.map(c => (\n            <div key={c.id}>\n              {c.type}: {c.value}\n            </div>\n          ))}\n        </div>\n      </div>\n    </div>\n  )\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}